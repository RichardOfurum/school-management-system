(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8322],{97572:function(e,t,a){Promise.resolve().then(a.bind(a,7831))},58064:function(e,t,a){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return s}});let l=a(74590);function s(e){let{createServerReference:t}=a(6671);return t(e,l.callServer)}},7831:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var l=a(57437);a(74590);var s=a(58064),n=(0,s.$)("138980c6b9eb20252f4b4136d2eb19d59f1b343e"),r=(0,s.$)("dedf9382904591a7356e1a5602839221bfa41c87"),c=(0,s.$)("89da5b80eb71711ad3df807fd326ba61a685cc45"),d=a(2265);function i(){let[e,t]=(0,d.useState)(!1),[a,s]=(0,d.useState)(!1),[i,o]=(0,d.useState)(!1),[u,b]=(0,d.useState)(null),[m,h]=(0,d.useState)(null),x=(0,d.useRef)(null),[f,p]=(0,d.useState)(null),g=async()=>{t(!0),b(null),h(null);try{let e=await r(),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download="school-database-backup-".concat(new Date().toISOString(),".json"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a),h("Backup created and downloaded successfully")}catch(e){b(e instanceof Error?e.message:"An unknown error occurred")}finally{t(!1)}},j=e=>{var t;p(e),null===(t=x.current)||void 0===t||t.click()},v=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a&&f){"full"===f?s(!0):o(!0),b(null),h(null);try{let e;let t=await a.text();(e="full"===f?await c(t):await n(t)).success&&h(e.message)}catch(e){b(e instanceof Error?e.message:"Failed to ".concat(f,"ly restore database"))}finally{s(!1),o(!1),p(null),x.current&&(x.current.value="")}}};return(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Database Backup & Restore"}),(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md space-y-6",children:[(0,l.jsxs)("section",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Backup Database"}),(0,l.jsx)("p",{className:"mb-4",children:"Create a complete backup of the database. This will download all data as a JSON file."}),(0,l.jsx)("button",{onClick:g,disabled:e||a||i,className:"px-4 py-2 rounded-md text-white ".concat(e||a||i?"bg-gray-400":"bg-blue-600 hover:bg-blue-700"),children:e?"Creating Backup...":"Backup Database"})]}),(0,l.jsxs)("section",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Restore Database"}),(0,l.jsx)("input",{type:"file",ref:x,onChange:v,accept:".json",className:"hidden"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Full Restore"}),(0,l.jsx)("p",{className:"mb-2 text-sm text-gray-600",children:"This will delete ALL existing data and replace it with the backup data."}),(0,l.jsx)("button",{onClick:()=>j("full"),disabled:e||a||i,className:"px-4 py-2 rounded-md text-white ".concat(e||a||i?"bg-gray-400":"bg-red-600 hover:bg-red-700"),children:a?"Restoring...":"Full Restore (Overwrite All)"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Partial Restore"}),(0,l.jsx)("p",{className:"mb-2 text-sm text-gray-600",children:"This will add new data from the backup but keep existing records."}),(0,l.jsx)("button",{onClick:()=>j("partial"),disabled:e||a||i,className:"px-4 py-2 rounded-md text-white ".concat(e||a||i?"bg-gray-400":"bg-green-600 hover:bg-green-700"),children:i?"Restoring...":"Partial Restore (Keep Existing)"})]})]})]}),u&&(0,l.jsxs)("div",{className:"mt-4 p-3 bg-red-100 text-red-700 rounded-md",children:["Error: ",u]}),m&&(0,l.jsx)("div",{className:"mt-4 p-3 bg-green-100 text-green-700 rounded-md",children:m}),(e||a||i)&&(0,l.jsx)("div",{className:"mt-4 p-3 bg-blue-100 text-blue-700 rounded-md",children:e?"Preparing your backup file...":a?"Performing full restore...":"Performing partial restore..."})]})]})}}},function(e){e.O(0,[2971,7023,1744],function(){return e(e.s=97572)}),_N_E=e.O()}]);