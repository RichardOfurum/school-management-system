"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2047],{38113:function(e,s,r){var a=r(57437);s.Z=e=>{let{label:s,type:r="text",register:t,name:i,defaultValue:n,error:l,hidden:o,inputProps:d}=e;return(0,a.jsxs)("div",{className:o?"hidden":"flex flex-col gap-1 w-full",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:s}),(0,a.jsx)("input",{type:r,...t(i),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",...d,defaultValue:n}),(null==l?void 0:l.message)&&(0,a.jsx)("p",{className:"text-xs text-red-500 mt-1",children:l.message.toString()})]})}},82047:function(e,s,r){r.r(s);var a=r(57437),t=r(31014),i=r(39343),n=r(38113),l=r(66648),o=r(2265),d=r(80118),c=r(54887),m=r(31721),u=r(16463),g=r(24648),p=r(17273);s.default=e=>{var s,r,b,x;let{type:z,data:f,setOpen:h,relatedData:j}=e,{register:v,handleSubmit:y,formState:{errors:q}}=(0,i.cI)({resolver:(0,t.F)(d.Q1)}),[N,w]=(0,o.useState)(!1),[I,S]=(0,o.useState)(),[P,T]=(0,o.useState)(),[A,E]=(0,c.useFormState)("create"===z?m.LK:m.Gc,{success:!1,error:!1}),L=y(e=>{w(!0),console.log("hello"),console.log(e),E({...e,img:P&&"update"===z?P:null==I?void 0:I.secure_url})}),Z=(0,u.useRouter)();(0,o.useEffect)(()=>{A.success&&(w(!1),g.Am.success("Student has been ".concat("create"===z?"created":"updated","!")),h(!1),Z.refresh()),A.error&&(w(!1),g.Am.error(A.error))},[A,Z,z,h]),(0,o.useEffect)(()=>{f&&T(f.img)});let{grades:D=[],classes:V=[],parents:F=[]}=j||{};return(0,a.jsxs)("form",{className:"flex flex-col gap-6 p-6 bg-white rounded-lg shadow-md max-h-[80vh] overflow-y-auto scrollbar-thin",onSubmit:L,children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"create"===z?"Create a New Student":"Update Student"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Authentication Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsx)(n.Z,{label:"Username",name:"username",defaultValue:null==f?void 0:f.username,register:v,error:null==q?void 0:q.username}),(0,a.jsx)(n.Z,{label:"Email",name:"email",defaultValue:null==f?void 0:f.email,register:v,error:null==q?void 0:q.email}),(0,a.jsx)(n.Z,{label:"Password",name:"password",type:"password",defaultValue:null==f?void 0:f.password,register:v,error:null==q?void 0:q.password})]})]}),(0,a.jsx)(p.ZF,{uploadPreset:"school",onSuccess:(e,s)=>{let{widget:r}=s;S(e.info),r.close()},children:e=>{let{open:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col gap-2 cursor-pointer",onClick:()=>s(),children:[(0,a.jsx)("label",{className:"text-xs text-gray-500",children:"Profile Photo"}),(0,a.jsx)("div",{className:"w-full h-32 bg-gray-100 rounded-md flex items-center justify-center overflow-hidden",children:P||I?(0,a.jsx)(l.default,{src:P||I.secure_url,alt:"Uploaded",width:120,height:120,className:"object-cover"}):(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(l.default,{src:"/upload.png",alt:"Upload",width:28,height:28}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Upload a photo"})]})})]})}}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsx)(n.Z,{label:"First Name",name:"name",defaultValue:null==f?void 0:f.name,register:v,error:q.name}),(0,a.jsx)(n.Z,{label:"Last Name",name:"surname",defaultValue:null==f?void 0:f.surname,register:v,error:q.surname}),(0,a.jsx)(n.Z,{label:"Phone",name:"phone",defaultValue:null==f?void 0:f.phone,register:v,error:q.phone}),(0,a.jsx)(n.Z,{label:"Address",name:"address",defaultValue:null==f?void 0:f.address,register:v,error:q.address}),(0,a.jsx)(n.Z,{label:"Blood Type",name:"bloodType",defaultValue:null==f?void 0:f.bloodType,register:v,error:q.bloodType}),(0,a.jsx)(n.Z,{label:"Birthday",name:"birthday",defaultValue:null==f?void 0:f.birthday.toISOString().split("T")[0],register:v,error:q.birthday,type:"date"}),f&&(0,a.jsx)(n.Z,{label:"Id",name:"id",defaultValue:null==f?void 0:f.id,register:v,error:null==q?void 0:q.id,hidden:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Additional Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-xs text-gray-500",children:"Sex"}),(0,a.jsxs)("select",{className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",...v("sex"),defaultValue:null==f?void 0:f.sex,children:[(0,a.jsx)("option",{value:"MALE",children:"Male"}),(0,a.jsx)("option",{value:"FEMALE",children:"Female"})]}),(null===(s=q.sex)||void 0===s?void 0:s.message)&&(0,a.jsx)("p",{className:"text-xs text-red-500",children:q.sex.message.toString()})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-xs text-gray-500",children:"Parent"}),(0,a.jsx)("select",{className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",...v("parentId"),defaultValue:null==f?void 0:f.parentId,children:F.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name+" "+e.surname},e.id))}),(null===(r=q.gradeId)||void 0===r?void 0:r.message)&&(0,a.jsx)("p",{className:"text-xs text-red-500",children:q.gradeId.message.toString()})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-xs text-gray-500",children:"Grade"}),(0,a.jsx)("select",{className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",...v("gradeId"),defaultValue:null==f?void 0:f.gradeId,children:D.map(e=>(0,a.jsx)("option",{value:e.id,children:e.level},e.id))}),(null===(b=q.gradeId)||void 0===b?void 0:b.message)&&(0,a.jsx)("p",{className:"text-xs text-red-500",children:q.gradeId.message.toString()})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-xs text-gray-500",children:"Class"}),(0,a.jsx)("select",{className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",...v("classId"),defaultValue:null==f?void 0:f.classId,children:V.map(e=>(0,a.jsxs)("option",{value:e.id,children:["(",e.name," -"," ",e._count.students+"/"+e.capacity," ","Capacity)"]},e.id))}),(null===(x=q.classId)||void 0===x?void 0:x.message)&&(0,a.jsx)("p",{className:"text-xs text-red-500",children:q.classId.message.toString()})]})]})]}),A.error&&(0,a.jsx)("div",{className:"text-red-500 text-sm mt-4",children:A.error}),(0,a.jsx)("button",{className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition-colors disabled:bg-blue-300",type:"submit",disabled:N,children:N?"Loading...":"create"===z?"Create":"Update"})]})}},80118:function(e,s,r){r.d(s,{O7:function(){return x},ON:function(){return m},Q1:function(){return l},Qu:function(){return o},Rj:function(){return z},UQ:function(){return i},Xj:function(){return d},a2:function(){return u},aD:function(){return f},iQ:function(){return n},k:function(){return b},o6:function(){return p},qJ:function(){return t},rA:function(){return c},zi:function(){return g}});var a=r(59772);let t=a.z.object({id:a.z.coerce.number().optional(),name:a.z.string().min(1,{message:"Subject name is required!"}),teachers:a.z.array(a.z.string())}),i=a.z.object({id:a.z.coerce.number().optional(),name:a.z.string().min(1,{message:"Subject name is required!"}),capacity:a.z.coerce.number().min(1,{message:"Capacity name is required!"}),gradeId:a.z.coerce.number().min(1,{message:"Grade name is required!"}),supervisorId:a.z.coerce.string().optional()}),n=a.z.object({id:a.z.string().optional(),username:a.z.string().min(10,{message:"Username must be at least 10 characters long!"}),password:a.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(a.z.literal("")),name:a.z.string().min(1,{message:"First name is required!"}),surname:a.z.string().min(1,{message:"Last name is required!"}),email:a.z.string().email({message:"Invalid email address!"}).optional().or(a.z.literal("")),phone:a.z.string().optional(),address:a.z.string(),img:a.z.string().optional(),bloodType:a.z.string().min(1,{message:"Blood Type is required!"}),birthday:a.z.coerce.date({message:"Birthday is required!"}),sex:a.z.enum(["MALE","FEMALE"],{message:"Sex is required!"}),subjects:a.z.array(a.z.string()).optional()}),l=a.z.object({id:a.z.string().optional(),username:a.z.string().min(10,{message:"Username must be at least 10 characters long!"}),password:a.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(a.z.literal("")),name:a.z.string().min(1,{message:"First name is required!"}),surname:a.z.string().min(1,{message:"Last name is required!"}),email:a.z.string().email({message:"Invalid email address!"}).optional().or(a.z.literal("")),phone:a.z.string().optional(),address:a.z.string(),img:a.z.string().optional(),bloodType:a.z.string().min(1,{message:"Blood Type is required!"}),birthday:a.z.coerce.date({message:"Birthday is required!"}),sex:a.z.enum(["MALE","FEMALE"],{message:"Sex is required!"}),gradeId:a.z.coerce.number().min(1,{message:"Grade is required!"}),classId:a.z.coerce.number().min(1,{message:"Class is required!"}),parentId:a.z.string().min(1,{message:"Parent Id is required!"})}),o=a.z.object({id:a.z.coerce.number().optional(),title:a.z.string().min(1,{message:"Title name is required!"}),startTime:a.z.coerce.date({message:"Start time is required!"}),endTime:a.z.coerce.date({message:"End time is required!"}),lessonId:a.z.coerce.number({message:"Lesson is required!"})}),d=a.z.object({id:a.z.string().optional(),username:a.z.string().min(10,{message:"Username must be at least 10 characters long!"}),password:a.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(a.z.literal("")),name:a.z.string().min(1,{message:"First name is required!"}),surname:a.z.string().min(1,{message:"Last name is required!"}),email:a.z.string().email({message:"Invalid email address!"}).optional().or(a.z.literal("")),phone:a.z.string().min(10,{message:"Phone number must be at least 10 digits long!"}).max(15,{message:"Phone number must be at most 15 digits long!"}),address:a.z.string().min(1,{message:"Address is required!"})}),c=a.z.object({id:a.z.coerce.number().optional(),title:a.z.string().min(1,{message:"Title is required!"}),description:a.z.string().min(1,{message:"Description is required!"}),startTime:a.z.coerce.date({message:"Start time is required!"}),endTime:a.z.coerce.date({message:"End time is required!"}),classId:a.z.coerce.number().optional()}).refine(e=>e.endTime>e.startTime,{message:"End time must be after start time!",path:["endTime"]}),m=a.z.object({id:a.z.coerce.number().optional(),name:a.z.string().min(1,{message:"Lesson name is required!"}),day:a.z.string().optional(),startTime:a.z.coerce.date({message:"Start time is required!"}),endTime:a.z.coerce.date({message:"End time is required!"}),subjectId:a.z.coerce.number().min(1,{message:"Subject ID is required!"}),classId:a.z.coerce.number().min(1,{message:"Class ID is required!"}),teacherId:a.z.string().optional()}).refine(e=>e.endTime>e.startTime,{message:"End time must be after start time!",path:["endTime"]}),u=a.z.object({id:a.z.string().optional(),username:a.z.string().min(1,{message:"Username is required!"}).max(50,{message:"Username must be at most 50 characters long!"}),firstName:a.z.string().min(1,{message:"First name is required!"}),surname:a.z.string().min(1,{message:"Last name is required!"}),password:a.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(a.z.literal(""))}),g=a.z.object({id:a.z.coerce.number().optional(),title:a.z.string().min(1,{message:"Title is required!"}),description:a.z.string().min(1,{message:"Description is required!"}),date:a.z.coerce.date({message:"Date is required!"}),classId:a.z.coerce.number().optional()}),p=a.z.object({id:a.z.coerce.number().optional(),level:a.z.coerce.number().min(1,{message:"Grade level is required!"}).refine(e=>Number.isInteger(e),{message:"Grade level must be an integer!"}),createdAt:a.z.coerce.date().optional(),updatedAt:a.z.coerce.date().optional()}),b=a.z.object({id:a.z.coerce.number().optional(),title:a.z.string().min(1,{message:"Title is required!"}),startDate:a.z.coerce.date({message:"Start date is required!"}),dueDate:a.z.coerce.date({message:"Due date is required!"}),lessonId:a.z.coerce.number().min(1,{message:"Lesson ID is required!"}),createdAt:a.z.coerce.date().optional(),updatedAt:a.z.coerce.date().optional()}).refine(e=>e.dueDate>e.startDate,{message:"Due date must be after start date!",path:["dueDate"]}),x=a.z.object({id:a.z.coerce.number().optional(),score:a.z.coerce.number().min(0,{message:"Score must be a non-negative number!"}),examId:a.z.coerce.number().optional(),assignmentId:a.z.coerce.number().optional(),studentId:a.z.string().min(1,{message:"Student ID is required!"}),createdAt:a.z.coerce.date().optional(),updatedAt:a.z.coerce.date().optional()}),z=a.z.object({id:a.z.coerce.number().optional(),title:a.z.string().min(1,{message:"Post Title required!"}),description:a.z.string().min(1,{message:"Post description required!"}),image:a.z.string().optional(),createdAt:a.z.coerce.date().optional(),updatedAt:a.z.coerce.date().optional()}),f=a.z.object({id:a.z.coerce.number().optional(),title:a.z.string().min(1,{message:"Title required!"}).max(100,{message:"Title must be less than 100 characters!"}),file:a.z.string().optional()})}}]);