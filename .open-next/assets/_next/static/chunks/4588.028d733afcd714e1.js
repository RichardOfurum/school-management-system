"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4588],{38113:function(e,s,t){var r=t(57437);s.Z=e=>{let{label:s,type:t="text",register:a,name:i,defaultValue:n,error:o,hidden:l,inputProps:d}=e;return(0,r.jsxs)("div",{className:l?"hidden":"flex flex-col gap-1 w-full",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:s}),(0,r.jsx)("input",{type:t,...a(i),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",...d,defaultValue:n}),(null==o?void 0:o.message)&&(0,r.jsx)("p",{className:"text-xs text-red-500 mt-1",children:o.message.toString()})]})}},54588:function(e,s,t){t.r(s);var r=t(57437),a=t(31014),i=t(39343),n=t(38113),o=t(80118),l=t(31721),d=t(54887),m=t(2265),c=t(24648),u=t(16463);s.default=e=>{var s;let{type:t,data:g,setOpen:b,relatedData:p}=e,{register:z,handleSubmit:f,formState:{errors:x}}=(0,i.cI)({resolver:(0,a.F)(o.Qu)}),[h,j]=(0,m.useState)(!1),[v,q]=(0,m.useState)(!1),[w,y]=(0,m.useState)([]),[I,N]=(0,d.useFormState)("create"===t?l.un:l.w0,{success:!1,error:!1}),T=f(e=>{j(!0),N(e)}),E=(0,u.useRouter)();(0,m.useEffect)(()=>{I.success&&(c.Am.success("Exam has been ".concat("create"===t?"created":"updated","!")),b(!1),E.refresh()),I.error&&(j(!1),c.Am.error(I.error))},[I,E,t,b]);let{lessons:S}=p,A=async()=>{if("update"===t&&(null==g?void 0:g.id))try{let e=await (0,l.Ug)(g.id);y(e.map(e=>({studentId:e.id,name:"".concat(e.name," ").concat(e.surname),score:0}))),q(!0)}catch(e){console.error("Error fetching students:",e),c.Am.error("Failed to fetch students")}},P=async()=>{try{await (0,l.DQ)(g.id,w.map(e=>({studentId:e.studentId,score:e.score}))),c.Am.success("Student results saved successfully!")}catch(e){console.error("Error saving student results:",e),c.Am.error("Failed to save student results")}};return(0,r.jsxs)("div",{className:"flex flex-col gap-6 p-6 bg-white rounded-lg shadow-lg max-h-[90vh] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"create"===t?"Create a New Exam":"Update Exam"}),(0,r.jsxs)("form",{className:"flex flex-col gap-6",onSubmit:T,children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(n.Z,{label:"Exam Title",name:"title",defaultValue:null==g?void 0:g.title,register:z,error:null==x?void 0:x.title}),(0,r.jsx)(n.Z,{label:"Start Date",name:"startTime",defaultValue:null==g?void 0:g.startTime,register:z,error:null==x?void 0:x.startTime,type:"datetime-local"}),(0,r.jsx)(n.Z,{label:"End Date",name:"endTime",defaultValue:null==g?void 0:g.endTime,register:z,error:null==x?void 0:x.endTime,type:"datetime-local"}),g&&(0,r.jsx)(n.Z,{label:"Id",name:"id",defaultValue:null==g?void 0:g.id,register:z,error:null==x?void 0:x.id,hidden:!0}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Lesson"}),(0,r.jsx)("select",{className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",...z("lessonId"),defaultValue:null==g?void 0:g.lessonId,children:S.map(e=>(0,r.jsx)("option",{value:e.id,className:"p-2",children:e.name},e.id))}),(null===(s=x.lessonId)||void 0===s?void 0:s.message)&&(0,r.jsx)("p",{className:"text-xs text-red-500 mt-1",children:x.lessonId.message.toString()})]})]}),I.error&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,r.jsx)("span",{className:"text-sm text-red-600",children:"Something went wrong! Please try again."})}),(0,r.jsx)("button",{type:"submit",className:"w-full md:w-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-all disabled:bg-blue-300",disabled:h,children:h?(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Processing..."})]}):"create"===t?"Create Exam":"Update Exam"})]}),"update"===t&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("p",{className:"md:w-auto px-6 py-3  text-black font-semibold rounded-lg cursor-pointer w-fit hover:text-gray-600",onClick:A,children:"Enter Students' Exam Results"}),v&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Students' Results"}),(0,r.jsx)("div",{className:"max-h-[300px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100",children:w.map((e,s)=>(0,r.jsxs)("div",{className:"flex flex-row gap-2 mb-4",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:e.name}),(0,r.jsx)("input",{type:"number",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",value:e.score,onChange:e=>{let t=[...w];t[s].score=parseInt(e.target.value),y(t)}})]},e.studentId))}),(0,r.jsx)("button",{type:"button",className:"w-full md:w-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-all mt-4",onClick:P,children:"Save Results"})]})]})]})}},80118:function(e,s,t){t.d(s,{O7:function(){return z},ON:function(){return c},Q1:function(){return o},Qu:function(){return l},Rj:function(){return f},UQ:function(){return i},Xj:function(){return d},a2:function(){return u},aD:function(){return x},iQ:function(){return n},k:function(){return p},o6:function(){return b},qJ:function(){return a},rA:function(){return m},zi:function(){return g}});var r=t(59772);let a=r.z.object({id:r.z.coerce.number().optional(),name:r.z.string().min(1,{message:"Subject name is required!"}),teachers:r.z.array(r.z.string())}),i=r.z.object({id:r.z.coerce.number().optional(),name:r.z.string().min(1,{message:"Subject name is required!"}),capacity:r.z.coerce.number().min(1,{message:"Capacity name is required!"}),gradeId:r.z.coerce.number().min(1,{message:"Grade name is required!"}),supervisorId:r.z.coerce.string().optional()}),n=r.z.object({id:r.z.string().optional(),username:r.z.string().min(10,{message:"Username must be at least 10 characters long!"}),password:r.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(r.z.literal("")),name:r.z.string().min(1,{message:"First name is required!"}),surname:r.z.string().min(1,{message:"Last name is required!"}),email:r.z.string().email({message:"Invalid email address!"}).optional().or(r.z.literal("")),phone:r.z.string().optional(),address:r.z.string(),img:r.z.string().optional(),bloodType:r.z.string().min(1,{message:"Blood Type is required!"}),birthday:r.z.coerce.date({message:"Birthday is required!"}),sex:r.z.enum(["MALE","FEMALE"],{message:"Sex is required!"}),subjects:r.z.array(r.z.string()).optional()}),o=r.z.object({id:r.z.string().optional(),username:r.z.string().min(10,{message:"Username must be at least 10 characters long!"}),password:r.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(r.z.literal("")),name:r.z.string().min(1,{message:"First name is required!"}),surname:r.z.string().min(1,{message:"Last name is required!"}),email:r.z.string().email({message:"Invalid email address!"}).optional().or(r.z.literal("")),phone:r.z.string().optional(),address:r.z.string(),img:r.z.string().optional(),bloodType:r.z.string().min(1,{message:"Blood Type is required!"}),birthday:r.z.coerce.date({message:"Birthday is required!"}),sex:r.z.enum(["MALE","FEMALE"],{message:"Sex is required!"}),gradeId:r.z.coerce.number().min(1,{message:"Grade is required!"}),classId:r.z.coerce.number().min(1,{message:"Class is required!"}),parentId:r.z.string().min(1,{message:"Parent Id is required!"})}),l=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title name is required!"}),startTime:r.z.coerce.date({message:"Start time is required!"}),endTime:r.z.coerce.date({message:"End time is required!"}),lessonId:r.z.coerce.number({message:"Lesson is required!"})}),d=r.z.object({id:r.z.string().optional(),username:r.z.string().min(10,{message:"Username must be at least 10 characters long!"}),password:r.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(r.z.literal("")),name:r.z.string().min(1,{message:"First name is required!"}),surname:r.z.string().min(1,{message:"Last name is required!"}),email:r.z.string().email({message:"Invalid email address!"}).optional().or(r.z.literal("")),phone:r.z.string().min(10,{message:"Phone number must be at least 10 digits long!"}).max(15,{message:"Phone number must be at most 15 digits long!"}),address:r.z.string().min(1,{message:"Address is required!"})}),m=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title is required!"}),description:r.z.string().min(1,{message:"Description is required!"}),startTime:r.z.coerce.date({message:"Start time is required!"}),endTime:r.z.coerce.date({message:"End time is required!"}),classId:r.z.coerce.number().optional()}).refine(e=>e.endTime>e.startTime,{message:"End time must be after start time!",path:["endTime"]}),c=r.z.object({id:r.z.coerce.number().optional(),name:r.z.string().min(1,{message:"Lesson name is required!"}),day:r.z.string().optional(),startTime:r.z.coerce.date({message:"Start time is required!"}),endTime:r.z.coerce.date({message:"End time is required!"}),subjectId:r.z.coerce.number().min(1,{message:"Subject ID is required!"}),classId:r.z.coerce.number().min(1,{message:"Class ID is required!"}),teacherId:r.z.string().optional()}).refine(e=>e.endTime>e.startTime,{message:"End time must be after start time!",path:["endTime"]}),u=r.z.object({id:r.z.string().optional(),username:r.z.string().min(1,{message:"Username is required!"}).max(50,{message:"Username must be at most 50 characters long!"}),firstName:r.z.string().min(1,{message:"First name is required!"}),surname:r.z.string().min(1,{message:"Last name is required!"}),password:r.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(r.z.literal(""))}),g=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title is required!"}),description:r.z.string().min(1,{message:"Description is required!"}),date:r.z.coerce.date({message:"Date is required!"}),classId:r.z.coerce.number().optional()}),b=r.z.object({id:r.z.coerce.number().optional(),level:r.z.coerce.number().min(1,{message:"Grade level is required!"}).refine(e=>Number.isInteger(e),{message:"Grade level must be an integer!"}),createdAt:r.z.coerce.date().optional(),updatedAt:r.z.coerce.date().optional()}),p=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title is required!"}),startDate:r.z.coerce.date({message:"Start date is required!"}),dueDate:r.z.coerce.date({message:"Due date is required!"}),lessonId:r.z.coerce.number().min(1,{message:"Lesson ID is required!"}),createdAt:r.z.coerce.date().optional(),updatedAt:r.z.coerce.date().optional()}).refine(e=>e.dueDate>e.startDate,{message:"Due date must be after start date!",path:["dueDate"]}),z=r.z.object({id:r.z.coerce.number().optional(),score:r.z.coerce.number().min(0,{message:"Score must be a non-negative number!"}),examId:r.z.coerce.number().optional(),assignmentId:r.z.coerce.number().optional(),studentId:r.z.string().min(1,{message:"Student ID is required!"}),createdAt:r.z.coerce.date().optional(),updatedAt:r.z.coerce.date().optional()}),f=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Post Title required!"}),description:r.z.string().min(1,{message:"Post description required!"}),image:r.z.string().optional(),createdAt:r.z.coerce.date().optional(),updatedAt:r.z.coerce.date().optional()}),x=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title required!"}).max(100,{message:"Title must be less than 100 characters!"}),file:r.z.string().optional()})}}]);