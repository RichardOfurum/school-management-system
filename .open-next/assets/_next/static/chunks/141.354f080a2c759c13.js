"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[141],{38113:function(e,t,s){var r=s(57437);t.Z=e=>{let{label:t,type:s="text",register:a,name:i,defaultValue:n,error:o,hidden:d,inputProps:l}=e;return(0,r.jsxs)("div",{className:d?"hidden":"flex flex-col gap-1 w-full",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:t}),(0,r.jsx)("input",{type:s,...a(i),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",...l,defaultValue:n}),(null==o?void 0:o.message)&&(0,r.jsx)("p",{className:"text-xs text-red-500 mt-1",children:o.message.toString()})]})}},60141:function(e,t,s){s.r(t);var r=s(57437),a=s(31014),i=s(39343),n=s(38113),o=s(66648),d=s(2265),l=s(80118),m=s(54887),c=s(31721),u=s(16463),g=s(24648),p=s(17273);t.default=e=>{var t;let{type:s,data:z,setOpen:b}=e,{register:f,handleSubmit:h,setValue:x,formState:{errors:q}}=(0,i.cI)({resolver:(0,a.F)(l.Rj),defaultValues:{title:(null==z?void 0:z.title)||"",description:(null==z?void 0:z.description)||"",image:(null==z?void 0:z.image)||""}}),[j,v]=(0,d.useState)(!1),[w,y]=(0,d.useState)(),[I,P]=(0,d.useState)((null==z?void 0:z.image)||""),[N,T]=(0,m.useFormState)("create"===s?c.qb:c.CP,{success:!1,error:null}),S=h(e=>{try{v(!0);let t=new FormData;t.append("title",e.title),t.append("description",e.description),t.append("image",(null==w?void 0:w.secure_url)||I),"update"===s&&(null==z?void 0:z.id)&&t.append("id",z.id.toString()),T(t)}catch(e){v(!1),g.Am.error("Something went wrong, please try again!")}}),A=(0,u.useRouter)();return(0,d.useEffect)(()=>{N.success&&(v(!1),g.Am.success("Post has been ".concat("create"===s?"created":"updated","!")),b(!1),A.refresh()),N.error&&(v(!1),g.Am.error(N.error))},[N,A,s,b]),(0,d.useEffect)(()=>{z&&(x("title",z.title),x("description",z.description),P(z.image))},[z,x]),(0,r.jsxs)("form",{className:"flex flex-col gap-6 p-6 bg-white rounded-lg shadow-md max-h-[80vh] overflow-y-auto scrollbar-thin",onSubmit:S,children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"create"===s?"Create a New Post":"Update Post"}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(n.Z,{label:"Title",name:"title",defaultValue:null==z?void 0:z.title,register:f,error:null==q?void 0:q.title})}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(p.ZF,{uploadPreset:"school",onSuccess:(e,t)=>{let{widget:s}=t;y(e.info),P(""),s.close()},children:e=>{let{open:t}=e;return(0,r.jsxs)("div",{className:"flex flex-col gap-2 cursor-pointer",onClick:()=>t(),children:[(0,r.jsx)("label",{className:"text-xs text-gray-500",children:"Post Image"}),(0,r.jsx)("div",{className:"w-full h-32 bg-gray-100 rounded-md flex items-center justify-center overflow-hidden",children:(null==w?void 0:w.secure_url)||I?(0,r.jsx)(o.default,{src:(null==w?void 0:w.secure_url)||I,alt:"Uploaded",width:120,height:120,className:"object-cover"}):(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)(o.default,{src:"/upload.png",alt:"Upload",width:28,height:28}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"Upload an image"})]})})]})}})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{...f("description"),defaultValue:null==z?void 0:z.description,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:5,placeholder:"Enter post description..."}),(null===(t=q.description)||void 0===t?void 0:t.message)&&(0,r.jsx)("p",{className:"text-xs text-red-500 mt-1",children:q.description.message.toString()})]}),z&&(0,r.jsx)(n.Z,{label:"Id",name:"id",defaultValue:null==z?void 0:z.id,register:f,error:null==q?void 0:q.id,hidden:!0}),N.error&&(0,r.jsx)("div",{className:"text-red-500 text-sm mt-4",children:N.error}),(0,r.jsx)("button",{className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition-colors disabled:bg-blue-300",type:"submit",disabled:j,children:j?"Loading...":"create"===s?"Create":"Update"})]})}},80118:function(e,t,s){s.d(t,{O7:function(){return b},ON:function(){return c},Q1:function(){return o},Qu:function(){return d},Rj:function(){return f},UQ:function(){return i},Xj:function(){return l},a2:function(){return u},aD:function(){return h},iQ:function(){return n},k:function(){return z},o6:function(){return p},qJ:function(){return a},rA:function(){return m},zi:function(){return g}});var r=s(59772);let a=r.z.object({id:r.z.coerce.number().optional(),name:r.z.string().min(1,{message:"Subject name is required!"}),teachers:r.z.array(r.z.string())}),i=r.z.object({id:r.z.coerce.number().optional(),name:r.z.string().min(1,{message:"Subject name is required!"}),capacity:r.z.coerce.number().min(1,{message:"Capacity name is required!"}),gradeId:r.z.coerce.number().min(1,{message:"Grade name is required!"}),supervisorId:r.z.coerce.string().optional()}),n=r.z.object({id:r.z.string().optional(),username:r.z.string().min(10,{message:"Username must be at least 10 characters long!"}),password:r.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(r.z.literal("")),name:r.z.string().min(1,{message:"First name is required!"}),surname:r.z.string().min(1,{message:"Last name is required!"}),email:r.z.string().email({message:"Invalid email address!"}).optional().or(r.z.literal("")),phone:r.z.string().optional(),address:r.z.string(),img:r.z.string().optional(),bloodType:r.z.string().min(1,{message:"Blood Type is required!"}),birthday:r.z.coerce.date({message:"Birthday is required!"}),sex:r.z.enum(["MALE","FEMALE"],{message:"Sex is required!"}),subjects:r.z.array(r.z.string()).optional()}),o=r.z.object({id:r.z.string().optional(),username:r.z.string().min(10,{message:"Username must be at least 10 characters long!"}),password:r.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(r.z.literal("")),name:r.z.string().min(1,{message:"First name is required!"}),surname:r.z.string().min(1,{message:"Last name is required!"}),email:r.z.string().email({message:"Invalid email address!"}).optional().or(r.z.literal("")),phone:r.z.string().optional(),address:r.z.string(),img:r.z.string().optional(),bloodType:r.z.string().min(1,{message:"Blood Type is required!"}),birthday:r.z.coerce.date({message:"Birthday is required!"}),sex:r.z.enum(["MALE","FEMALE"],{message:"Sex is required!"}),gradeId:r.z.coerce.number().min(1,{message:"Grade is required!"}),classId:r.z.coerce.number().min(1,{message:"Class is required!"}),parentId:r.z.string().min(1,{message:"Parent Id is required!"})}),d=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title name is required!"}),startTime:r.z.coerce.date({message:"Start time is required!"}),endTime:r.z.coerce.date({message:"End time is required!"}),lessonId:r.z.coerce.number({message:"Lesson is required!"})}),l=r.z.object({id:r.z.string().optional(),username:r.z.string().min(10,{message:"Username must be at least 10 characters long!"}),password:r.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(r.z.literal("")),name:r.z.string().min(1,{message:"First name is required!"}),surname:r.z.string().min(1,{message:"Last name is required!"}),email:r.z.string().email({message:"Invalid email address!"}).optional().or(r.z.literal("")),phone:r.z.string().min(10,{message:"Phone number must be at least 10 digits long!"}).max(15,{message:"Phone number must be at most 15 digits long!"}),address:r.z.string().min(1,{message:"Address is required!"})}),m=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title is required!"}),description:r.z.string().min(1,{message:"Description is required!"}),startTime:r.z.coerce.date({message:"Start time is required!"}),endTime:r.z.coerce.date({message:"End time is required!"}),classId:r.z.coerce.number().optional()}).refine(e=>e.endTime>e.startTime,{message:"End time must be after start time!",path:["endTime"]}),c=r.z.object({id:r.z.coerce.number().optional(),name:r.z.string().min(1,{message:"Lesson name is required!"}),day:r.z.string().optional(),startTime:r.z.coerce.date({message:"Start time is required!"}),endTime:r.z.coerce.date({message:"End time is required!"}),subjectId:r.z.coerce.number().min(1,{message:"Subject ID is required!"}),classId:r.z.coerce.number().min(1,{message:"Class ID is required!"}),teacherId:r.z.string().optional()}).refine(e=>e.endTime>e.startTime,{message:"End time must be after start time!",path:["endTime"]}),u=r.z.object({id:r.z.string().optional(),username:r.z.string().min(1,{message:"Username is required!"}).max(50,{message:"Username must be at most 50 characters long!"}),firstName:r.z.string().min(1,{message:"First name is required!"}),surname:r.z.string().min(1,{message:"Last name is required!"}),password:r.z.string().min(8,{message:"Password must be at least 8 characters long!"}).refine(e=>/[A-Z]/.test(e),"Password must contain at least one capital letter!").refine(e=>/[0-9]/.test(e),"Password must contain at least one number!").refine(e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e),"Password must contain at least one special character!").optional().or(r.z.literal(""))}),g=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title is required!"}),description:r.z.string().min(1,{message:"Description is required!"}),date:r.z.coerce.date({message:"Date is required!"}),classId:r.z.coerce.number().optional()}),p=r.z.object({id:r.z.coerce.number().optional(),level:r.z.coerce.number().min(1,{message:"Grade level is required!"}).refine(e=>Number.isInteger(e),{message:"Grade level must be an integer!"}),createdAt:r.z.coerce.date().optional(),updatedAt:r.z.coerce.date().optional()}),z=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title is required!"}),startDate:r.z.coerce.date({message:"Start date is required!"}),dueDate:r.z.coerce.date({message:"Due date is required!"}),lessonId:r.z.coerce.number().min(1,{message:"Lesson ID is required!"}),createdAt:r.z.coerce.date().optional(),updatedAt:r.z.coerce.date().optional()}).refine(e=>e.dueDate>e.startDate,{message:"Due date must be after start date!",path:["dueDate"]}),b=r.z.object({id:r.z.coerce.number().optional(),score:r.z.coerce.number().min(0,{message:"Score must be a non-negative number!"}),examId:r.z.coerce.number().optional(),assignmentId:r.z.coerce.number().optional(),studentId:r.z.string().min(1,{message:"Student ID is required!"}),createdAt:r.z.coerce.date().optional(),updatedAt:r.z.coerce.date().optional()}),f=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Post Title required!"}),description:r.z.string().min(1,{message:"Post description required!"}),image:r.z.string().optional(),createdAt:r.z.coerce.date().optional(),updatedAt:r.z.coerce.date().optional()}),h=r.z.object({id:r.z.coerce.number().optional(),title:r.z.string().min(1,{message:"Title required!"}).max(100,{message:"Title must be less than 100 characters!"}),file:r.z.string().optional()})}}]);